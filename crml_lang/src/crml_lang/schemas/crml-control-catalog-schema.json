{
  "$defs": {
    "CompanySizeToken": {
      "description": "Canonical CRML company size tokens.\n\nValues are strict and must match exactly.",
      "enum": [
        "all",
        "micro",
        "small",
        "medium",
        "large",
        "enterprise"
      ],
      "title": "CompanySizeToken",
      "type": "string"
    },
    "ControlCatalog": {
      "properties": {
        "id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional identifier for this catalog (organization-owned).",
          "title": "Id"
        },
        "oscal_uuid": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional OSCAL UUID for the source catalog (interoperability metadata). CRML tooling should continue to reference the catalog via 'catalog.id' and controls via canonical 'id'.",
          "title": "Oscal Uuid"
        },
        "framework": {
          "description": "Free-form framework label for humans/tools.",
          "title": "Framework",
          "type": "string"
        },
        "controls": {
          "description": "List of catalog entries.",
          "items": {
            "$ref": "#/$defs/ControlCatalogEntry"
          },
          "title": "Controls",
          "type": "array"
        },
        "groups": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/ControlCatalogGroup"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional hierarchical group structure (e.g., OSCAL groups). Groups reference controls by id via 'control_ids'.",
          "title": "Groups"
        }
      },
      "required": [
        "framework",
        "controls"
      ],
      "title": "ControlCatalog",
      "type": "object"
    },
    "ControlCatalogEntry": {
      "description": "Portable metadata about a control id.\n\nImportant: do not embed copyrighted standard text here.\nKeep this to identifiers and tool-friendly metadata.",
      "properties": {
        "id": {
          "description": "Canonical unique control id present in this catalog.",
          "maxLength": 256,
          "minLength": 1,
          "not": {
            "pattern": "^attck:"
          },
          "pattern": "^[a-z][a-z0-9_-]{0,31}:[^\\s]{1,223}$",
          "title": "Id",
          "type": "string"
        },
        "oscal_uuid": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional OSCAL UUID for this control. This is interoperability metadata only; CRML tools should continue to reference this control via the canonical 'id'.",
          "title": "Oscal Uuid"
        },
        "ref": {
          "anyOf": [
            {
              "$ref": "#/$defs/ControlStructuredRef"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional structured locator to map the id to an external standard."
        },
        "title": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional short human-readable title for the control.",
          "title": "Title"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional free-form description text for this control entry. Only include standard/control prose if you have rights to distribute it.",
          "title": "Description"
        },
        "url": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional URL for additional reference material.",
          "title": "Url"
        },
        "tags": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of tags for grouping/filtering.",
          "title": "Tags"
        },
        "defense_in_depth_layers": {
          "anyOf": [
            {
              "items": {
                "enum": [
                  "prevent",
                  "detect",
                  "respond",
                  "recover"
                ],
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional defense-in-depth layer tags. Allowed values: prevent, detect, respond, recover.",
          "title": "Defense In Depth Layers"
        }
      },
      "required": [
        "id"
      ],
      "title": "ControlCatalogEntry",
      "type": "object"
    },
    "ControlCatalogGroup": {
      "description": "Optional hierarchical grouping for control catalogs.\n\nDesigned to represent OSCAL `groups[]` without duplicating control objects.",
      "properties": {
        "id": {
          "description": "Group identifier (OSCAL group id).",
          "title": "Id",
          "type": "string"
        },
        "oscal_uuid": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional OSCAL UUID for this group (interoperability metadata). CRML tooling should continue to reference groups by their in-document 'id'.",
          "title": "Oscal Uuid"
        },
        "title": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional human-readable group title.",
          "title": "Title"
        },
        "control_ids": {
          "anyOf": [
            {
              "items": {
                "description": "Canonical unique control id in the form 'namespace:key' (no whitespace). Examples: cap:edr, cisv8:4.2, iso27001:2022:A.5.1",
                "maxLength": 256,
                "minLength": 1,
                "not": {
                  "pattern": "^attck:"
                },
                "pattern": "^[a-z][a-z0-9_-]{0,31}:[^\\s]{1,223}$",
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of control ids that belong to this group.",
          "title": "Control Ids"
        },
        "groups": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/ControlCatalogGroup"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional nested sub-groups (recursive).",
          "title": "Groups"
        }
      },
      "required": [
        "id"
      ],
      "title": "ControlCatalogGroup",
      "type": "object"
    },
    "ControlStructuredRef": {
      "description": "Standard-independent structured control locator.\n\nThis is optional metadata that can be used by tools/UI to help users map\ncontrols, but *referencing* in scenarios/portfolios should be done via\n`ControlId`.\n\nExample:\n    {standard: \"CIS\", control: \"2\", requirement: \"Ensure X is implemented\"}",
      "properties": {
        "standard": {
          "description": "Standard identifier (e.g. CISv8, ISO27001).",
          "title": "Standard",
          "type": "string"
        },
        "control": {
          "description": "Control identifier within the referenced standard.",
          "title": "Control",
          "type": "string"
        },
        "requirement": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional requirement text (what the requirement specifies) within the referenced standard (if applicable and not copyrighted).",
          "title": "Requirement"
        }
      },
      "required": [
        "standard",
        "control"
      ],
      "title": "ControlStructuredRef",
      "type": "object"
    },
    "IndustryToken": {
      "description": "Canonical CRML industry tokens.\n\nValues are strict and must match exactly.",
      "enum": [
        "all",
        "financial-services",
        "healthcare",
        "manufacturing",
        "retail-wholesale",
        "technology",
        "professional-services",
        "education",
        "government",
        "energy-utilities",
        "transportation-logistics",
        "media-entertainment",
        "construction-real-estate",
        "hospitality-food-service",
        "nonprofit-ngo"
      ],
      "title": "IndustryToken",
      "type": "string"
    },
    "Meta": {
      "properties": {
        "name": {
          "description": "Human-friendly name for this document.",
          "title": "Name",
          "type": "string"
        },
        "version": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional version string for this document.",
          "title": "Version"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional free-form description.",
          "title": "Description"
        },
        "reference": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional reference URL for this document (provenance pointer). Tools should set this only when the source is a URL (not a local path).",
          "title": "Reference"
        },
        "author": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional author/owner.",
          "title": "Author"
        },
        "organization": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional organization name.",
          "title": "Organization"
        },
        "industries": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/IndustryToken"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of industry tags.",
          "title": "Industries"
        },
        "locale": {
          "additionalProperties": true,
          "description": "Optional locale/region information and arbitrary locale metadata.",
          "properties": {
            "regions": {
              "anyOf": [
                {
                  "items": {
                    "enum": [
                      "all",
                      "world",
                      "north-america",
                      "latin-america",
                      "europe",
                      "middle-east-africa",
                      "asia-pacific",
                      "oceania"
                    ],
                    "type": "string"
                  },
                  "type": "array"
                },
                {
                  "type": "null"
                }
              ],
              "default": null,
              "description": "Optional list of region tokens.",
              "title": "Regions"
            },
            "countries": {
              "anyOf": [
                {
                  "items": {
                    "description": "ISO 3166-1 alpha-2 country code (uppercase).",
                    "pattern": "^[A-Z]{2}$",
                    "title": "iso3166_1_alpha2",
                    "type": "string"
                  },
                  "type": "array"
                },
                {
                  "type": "null"
                }
              ],
              "default": null,
              "description": "Optional list of ISO 3166-1 alpha-2 country codes.",
              "title": "Countries"
            }
          },
          "title": "Locale",
          "type": "object"
        },
        "company_sizes": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/CompanySizeToken"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of company size tags.",
          "title": "Company Sizes"
        },
        "regulatory_frameworks": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of regulatory frameworks relevant to this document.",
          "title": "Regulatory Frameworks"
        },
        "tags": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of user-defined tags.",
          "title": "Tags"
        },
        "attck": {
          "anyOf": [
            {
              "items": {
                "description": "ATT&CK identifier in canonical namespaced form 'namespace:key' (no whitespace). Recommended namespace is 'attck'. Examples: attck:TA0001, attck:T1059, attck:T1059.003",
                "maxLength": 256,
                "minLength": 1,
                "pattern": "^[a-z][a-z0-9_-]{0,31}:[^\\s]{1,223}$",
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of ATT&CK tactic/technique/sub-technique identifiers relevant to this document, expressed as namespaced ids (e.g. 'attck:T1059.003').",
          "title": "Attck"
        }
      },
      "required": [
        "name"
      ],
      "title": "Meta",
      "type": "object"
    },
    "iso3166_1_alpha2": {
      "type": "string",
      "title": "iso3166_1_alpha2",
      "description": "ISO 3166-1 alpha-2 country code (uppercase).",
      "pattern": "^[A-Z]{2}$"
    }
  },
  "properties": {
    "crml_control_catalog": {
      "const": "1.0",
      "description": "Control catalog document version identifier.",
      "title": "Crml Control Catalog",
      "type": "string"
    },
    "meta": {
      "$ref": "#/$defs/Meta",
      "description": "Document metadata (name, description, tags, etc.)."
    },
    "catalog": {
      "$ref": "#/$defs/ControlCatalog",
      "description": "The control catalog payload."
    }
  },
  "required": [
    "crml_control_catalog",
    "meta",
    "catalog"
  ],
  "title": "CRControlCatalog",
  "type": "object"
}
